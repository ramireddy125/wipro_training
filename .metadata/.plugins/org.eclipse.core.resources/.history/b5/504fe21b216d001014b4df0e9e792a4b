package com.day_10;

import java.util.*;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;

class Appointment {
    String patientName;
    LocalDateTime dateTime;

    Appointment(String patientName, LocalDateTime dateTime) {
        this.patientName = patientName;
        this.dateTime = dateTime;
    }

    public String toString() {
        DateTimeFormatter formatter = DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm");
        return patientName + " - " + dateTime.format(formatter);
    }

    public boolean equals(Object obj) {
        if (this == obj) return true;
        if (!(obj instanceof Appointment)) return false;
        Appointment a = (Appointment) obj;
        return this.patientName.equalsIgnoreCase(a.patientName) &&
               this.dateTime.equals(a.dateTime);
    }

    public int hashCode() {
        return Objects.hash(patientName.toLowerCase(), dateTime);
    }
}

public class TreeSet_Ex {

    public static void main(String[] args) {

        Scanner sc = new Scanner(System.in);
        DateTimeFormatter formatter = DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm");

        TreeSet<Appointment> appointments = new TreeSet<>(new Comparator<Appointment>() {
            public int compare(Appointment a1, Appointment a2) {
                if (a1.dateTime.equals(a2.dateTime)) {
                    return a1.patientName.compareToIgnoreCase(a2.patientName);
                }
                return a1.dateTime.compareTo(a2.dateTime);
            }
        });

        System.out.print("How many appointments to add? ");
        int n = sc.nextInt();
        sc.nextLine(); 

        for (int i = 0; i < n; i++) {
            System.out.print("Enter patient name: ");
            String name = sc.nextLine();

            System.out.print("Enter date and time (yyyy-MM-dd HH:mm): ");
            String inputTime = sc.nextLine();

            LocalDateTime dateTime = LocalDateTime.parse(inputTime, formatter);
            Appointment appt = new Appointment(name, dateTime);

            if (appointments.contains(appt)) {
                System.out.println("Duplicate appointment! Skipped.");
            } else {
                appointments.add(appt);
                System.out.println(" Appointment added.");
            }
        }

        System.out.println("\n Scheduled Appointments:");
        for (Appointment a : appointments) {
            System.out.println(a);
        }
        sc.close();
    }
}
